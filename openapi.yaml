openapi: 3.0.3
info:
  title: Hostel Management API
  version: 1.0.0
  description: API for managing hostel and private boarding systems
servers:
  - url: http://localhost:3000
    description: Local server

components:
  schemas:
    Error:
      type: object
      properties:
        error:
          type: string
      required:
        - error

    User:
      type: object
      properties:
        id:
          type: integer
        username:
          type: string
        password:
          type: string
        email:
          type: string
        phoneNumber:
          type: string
        role:
          type: string
          enum: [ADMIN, STANDARD_USER]
        student:
          type: object
          $ref: "#/components/schemas/Student"
        privateBoardingOwner:
          type: object
          $ref: "#/components/schemas/PrivateBoardingOwner"

    Student:
      type: object
      properties:
        studentId:
          type: string
        userId:
          type: integer
        roomId:
          type: integer
        rooms:
          type: array
          items:
            $ref: "#/components/schemas/Room"
        exchangeRequestsFromUser:
          type: array
          items:
            $ref: "#/components/schemas/ExchangeRequest"
        exchangeRequestsToUser:
          type: array
          items:
            $ref: "#/components/schemas/ExchangeRequest"

    PrivateBoardingOwner:
      type: object
      properties:
        id:
          type: integer
        userId:
          type: integer
        privateBoardings:
          type: array
          items:
            $ref: "#/components/schemas/PrivateBoarding"

    Hostel:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        genderType:
          type: string
          enum: [MALE, FEMALE, MIXED]
        distance:
          type: number
          format: float
        location:
          type: string
        year:
          type: string
          enum: [FIRST, SECOND, THIRD, FOURTH]
        rooms:
          type: array
          items:
            $ref: "#/components/schemas/Room"

    Room:
      type: object
      properties:
        id:
          type: integer
        capacity:
          type: integer
        beds:
          type: integer
        hostelId:
          type: integer
        students:
          type: array
          items:
            $ref: "#/components/schemas/Student"

    ExchangeRequest:
      type: object
      properties:
        id:
          type: integer
        status:
          type: string
          enum: [PENDING, ACCEPTED, REJECTED]
        fromUserId:
          type: integer
        fromUser:
          type: object
          $ref: "#/components/schemas/Student"
        toUserId:
          type: integer
        toUser:
          type: object
          $ref: "#/components/schemas/Student"

    PrivateBoarding:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        location:
          type: string
        distance:
          type: number
          format: float
        ownerId:
          type: integer
        owner:
          type: object
          $ref: "#/components/schemas/PrivateBoardingOwner"
        description:
          type: string
        boardingRooms:
          type: array
          items:
            $ref: "#/components/schemas/BoardingRoom"

    BoardingRoom:
      type: object
      properties:
        id:
          type: integer
        capacity:
          type: integer
        facilities:
          type: string
        boardingId:
          type: integer
        description:
          type: string
        rent:
          type: number
          format: float

paths:
  /hostels:
    get:
      summary: Show all hostels details
      parameters:
        - in: query
          name: location
          required: false
          schema:
            type: string
        - in: query
          name: gender
          required: false
          schema:
            type: string
            enum: [MALE, FEMALE, MIXED]
        - in: query
          name: year
          required: false
          schema:
            type: string
            enum: [FIRST, SECOND, THIRD, FOURTH]
        - name: "limit"
          in: "query"
          required: false
          description: "Limit the number of results per page (default: 10)."
          schema:
            type: "integer"
            minimum: 1
            default: 10
        - name: "start"
          in: "query"
          required: false
          description: "Start index of results (zero-based)."
          schema:
            type: "integer"
            minimum: 0
            default: 0
      responses:
        "200":
          description: A list of all hostels
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Hostel"
        "400":
          description: Bad request
        "500":
          description: "Internal Server Error - Something went wrong on the server side."
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    post:
      summary: Create a new hostel
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Hostel"
      responses:
        "201":
          description: The created hostel
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Hostel"
        "400":
          description: Bad request
        "500":
          description: Internal server error
  /hostels/{id}:
    get:
      summary: Get a hostel by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: The hostel data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Hostel"
        "400":
          description: Bad request
        "404":
          description: Hostel not found
        "500":
          description: Internal server error
    put:
      summary: Update a hostel by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Hostel"
      responses:
        "200":
          description: The updated hostel
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Hostel"
        "400":
          description: Bad request
        "404":
          description: Hostel not found
        "500":
          description: Internal server error
    delete:
      summary: Delete a hostel by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        "204":
          description: The hostel was deleted
        "400":
          description: Bad request
        "404":
          description: Hostel not found
        "500":
          description: Internal server error

  /hostels/{id}/rooms:
    get:
      summary: List all rooms
      responses:
        "200":
          description: A list of rooms
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Room"
        "400":
          description: Bad request
        "404":
          description: Hostel not found
        "500":
          description: Internal server error
    post:
      summary: Create a new room
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Room"
      responses:
        "201":
          description: The created room
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Room"
        "400":
          description: Bad request
        "404":
          description: Hostel not found
        "500":
          description: Internal server error
  /hostels/{id}/rooms/{roomId}:
    get:
      summary: Get a room by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
        - in: path
          name: roomId
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: The room data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Room"
        "400":
          description: Bad request
        "404":
          description: Room not found
        "500":
          description: Internal server error
    put:
      summary: Update a room by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
        - in: path
          name: roomId
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Room"
      responses:
        "200":
          description: The updated room
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Room"
        "400":
          description: Bad request
        "404":
          description: Room not found
        "500":
          description: Internal server error
    delete:
      summary: Delete a room by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
        - in: path
          name: roomId
          required: true
          schema:
            type: integer
      responses:
        "204":
          description: The room was deleted
        "400":
          description: Bad request
        "404":
          description: Room not found
        "500":
          description: Internal server error

  /users:
    get:
      summary: List all users
      responses:
        "200":
          description: A list of users
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/User"
        "400":
          description: Bad request
        "500":
          description: Internal server error
    post:
      summary: Create a new user
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
      responses:
        "201":
          description: The created user
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Bad request
        "500":
          description: Internal server error
  /users/{id}:
    get:
      summary: Get a user by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: The user data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Bad request
        "404":
          description: User not found
        "500":
          description: Internal server error
    put:
      summary: Update a user by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
      responses:
        "200":
          description: The updated user
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Bad request
        "404":
          description: User not found
        "500":
          description: Internal server error
    delete:
      summary: Delete a user by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        "204":
          description: The user was deleted
        "400":
          description: Bad request
        "404":
          description: User not found
        "500":
          description: Internal server error

  /students:
    get:
      summary: List all students
      responses:
        "200":
          description: A list of students
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Student"
        "400":
          description: Bad request
        "500":
          description: Internal server error
    post:
      summary: Create a new student
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Student"
      responses:
        "201":
          description: The created student
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Student"
        "400":
          description: Bad request
        "500":
          description: Internal server error
  /students/{id}:
    get:
      summary: Get a student by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: The student data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Student"
        "400":
          description: Bad request
        "404":
          description: Student not found
        "500":
          description: Internal server error
    put:
      summary: Update a student by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Student"
      responses:
        "200":
          description: The updated student
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Student"
        "400":
          description: Bad request
        "404":
          description: Student not found
        "500":
          description: Internal server error
    delete:
      summary: Delete a student by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "204":
          description: The student was deleted
        "400":
          description: Bad request
        "404":
          description: Student not found
        "500":
          description: Internal server error

  /private-boarding-owners:
    get:
      summary: List all private boarding owners
      responses:
        "200":
          description: A list of private boarding owners
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/PrivateBoardingOwner"
        "400":
          description: Bad request
        "500":
          description: Internal server error
    post:
      summary: Create a new private boarding owner
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PrivateBoardingOwner"
      responses:
        "201":
          description: The created private boarding owner
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PrivateBoardingOwner"
        "400":
          description: Bad request
        "500":
          description: Internal server error
  /private-boarding-owners/{id}:
    get:
      summary: Get a private boarding owner by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: The private boarding owner data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PrivateBoardingOwner"
        "400":
          description: Bad request
        "404":
          description: Private boarding owner not found
        "500":
          description: Internal server error
    put:
      summary: Update a private boarding owner by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PrivateBoardingOwner"
      responses:
        "200":
          description: The updated private boarding owner
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PrivateBoardingOwner"
        "400":
          description: Bad request
        "404":
          description: Private boarding owner not found
        "500":
          description: Internal server error
    delete:
      summary: Delete a private boarding owner by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      responses:
        "204":
          description: The private boarding owner was deleted
        "400":
          description: Bad request
        "404":
          description: Private boarding owner not found
        "500":
          description: Internal server error

  /exchange-requests/{id}/update-state:
    put:
      summary: Update exchange request state to available
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                  enum: [AVAILABLE]
      responses:
        "200":
          description: The updated exchange request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExchangeRequest"
        "400":
          description: Bad request
        "404":
          description: Exchange request not found
        "500":
          description: Internal server error

  /apply-hostel:
    post:
      summary: Apply for a hostel
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                hostelId:
                  type: integer
                studentId:
                  type: string
      responses:
        "201":
          description: Applied for hostel
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "400":
          description: Bad request
        "500":
          description: Internal server error

  /room-requests:
    get:
      summary: Show all swap requests
      responses:
        "200":
          description: A list of swap requests
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ExchangeRequest"
        "400":
          description: Bad request
        "500":
          description: Internal server error
    post:
      summary: Apply for an exchange
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                fromUserId:
                  type: string
                toUserId:
                  type: string
      responses:
        "201":
          description: Applied for exchange
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "400":
          description: Bad request
        "500":
          description: Internal server error
  /room-requests/{id}:
    put:
      summary: Accept or reject a swap request
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                  enum: [ACCEPTED, REJECTED]
      responses:
        "200":
          description: The updated swap request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExchangeRequest"
        "400":
          description: Bad request
        "404":
          description: Swap request not found
        "500":
          description: Internal server error

  /allocation-students:
    post:
      summary: Allocate students to hostels
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                method:
                  type: string
                  enum: [manual, random]
                allocations:
                  type: array
                  items:
                    type: object
                    properties:
                      studentId:
                        type: string
                      hostelId:
                        type: integer
      responses:
        "200":
          description: Students allocated to hostels
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "400":
          description: Bad request
        "500":
          description: Internal server error

  /account:
    get:
      summary: Show account details
      parameters:
        - in: query
          name: userId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: The user account details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Bad request
        "404":
          description: User not found
        "500":
          description: Internal server error
